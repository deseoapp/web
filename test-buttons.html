<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Botones Chat</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .quick-actions { display: flex; gap: 10px; margin: 20px 0; }
        .quick-action-btn { 
            padding: 10px 15px; 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        .quick-action-btn:hover { background: #0056b3; }
        .modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.5); 
            z-index: 1000; 
        }
        .modal-content { 
            background: white; 
            margin: 50px auto; 
            padding: 20px; 
            width: 400px; 
            border-radius: 8px; 
        }
        .form-group { margin: 10px 0; }
        .form-group label { display: block; margin-bottom: 5px; }
        .form-group input, .form-group textarea { width: 100%; padding: 8px; }
        .btn-primary { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        .btn-secondary { background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Test de Botones Chat Cliente</h1>
    
    <div class="quick-actions">
        <button class="quick-action-btn" data-action="tip">
            <i>üí∞</i> Propina
        </button>
        <button class="quick-action-btn" data-action="request">
            <i>ü§ù</i> Solicitar servicio
        </button>
        <button class="quick-action-btn" data-action="favorite">
            <i>‚ù§Ô∏è</i> Favorito
        </button>
        <button class="quick-action-btn" data-action="report">
            <i>üö©</i> Reportar
        </button>
        <button class="quick-action-btn" data-action="urgent">
            <i>üö®</i> Urgente
        </button>
        <button class="quick-action-btn" data-action="rate">
            <i>‚≠ê</i> Calificar
        </button>
    </div>

    <!-- Modal: Propina -->
    <div class="modal" id="tipModal">
        <div class="modal-content">
            <h2>Enviar Propina</h2>
            <div class="form-group">
                <label for="tipAmount">Monto</label>
                <input type="number" id="tipAmount" placeholder="0" min="1" step="1">
            </div>
            <div class="form-group">
                <label for="tipNote">Nota (opcional)</label>
                <input type="text" id="tipNote" placeholder="Gracias por tu atenci√≥n...">
            </div>
            <button class="btn-primary" id="sendTipBtn">Enviar Propina</button>
            <button class="btn-secondary" onclick="closeModal('tipModal')">Cancelar</button>
        </div>
    </div>

    <!-- Modal: Solicitar servicio -->
    <div class="modal" id="requestServiceModal">
        <div class="modal-content">
            <h2>Solicitar Servicio</h2>
            <div class="form-group">
                <label for="reqTitle">T√≠tulo</label>
                <input type="text" id="reqTitle" placeholder="T√≠tulo del servicio">
            </div>
            <div class="form-group">
                <label for="reqDescription">Descripci√≥n</label>
                <textarea id="reqDescription" rows="4" placeholder="Describe lo que necesitas..."></textarea>
            </div>
            <div class="form-group">
                <label for="reqBudget">Presupuesto</label>
                <input type="number" id="reqBudget" placeholder="0" min="0" step="1">
            </div>
            <div class="form-group">
                <label for="reqWhen">¬øCu√°ndo?</label>
                <input type="datetime-local" id="reqWhen">
            </div>
            <button class="btn-primary" id="sendRequestServiceBtn">Solicitar</button>
            <button class="btn-secondary" onclick="closeModal('requestServiceModal')">Cancelar</button>
        </div>
    </div>

    <!-- Modal: Reportar -->
    <div class="modal" id="reportModal">
        <div class="modal-content">
            <h2>Reportar Usuario</h2>
            <div class="form-group">
                <label for="reportReason">Motivo del reporte</label>
                <select id="reportReason">
                    <option value="">Selecciona un motivo</option>
                    <option value="spam">Spam</option>
                    <option value="abuso">Abuso verbal</option>
                    <option value="fraude">Fraude</option>
                    <option value="contenido_inapropiado">Contenido inapropiado</option>
                    <option value="acoso">Acoso</option>
                    <option value="otro">Otro</option>
                </select>
            </div>
            <div class="form-group">
                <label for="reportDetails">Detalles del reporte</label>
                <textarea id="reportDetails" rows="4" placeholder="Describe detalladamente lo que ocurri√≥..." required></textarea>
            </div>
            <div class="form-group">
                <label for="reportImages">Im√°genes de prueba (opcional)</label>
                <input type="file" id="reportImages" accept="image/*" multiple>
                <small>Puedes subir hasta 5 im√°genes como evidencia</small>
            </div>
            <div id="reportImagePreview"></div>
            <button class="btn-primary" id="sendReportBtn">Enviar Reporte</button>
            <button class="btn-secondary" onclick="closeModal('reportModal')">Cancelar</button>
        </div>
    </div>

    <!-- Modal: Calificar -->
    <div class="modal" id="rateModal">
        <div class="modal-content">
            <h2>Calificar Servicio</h2>
            <div class="form-group">
                <label>Calificaci√≥n</label>
                <div id="starRating">
                    <span style="font-size: 24px; cursor: pointer;">‚≠ê</span>
                    <span style="font-size: 24px; cursor: pointer;">‚≠ê</span>
                    <span style="font-size: 24px; cursor: pointer;">‚≠ê</span>
                    <span style="font-size: 24px; cursor: pointer;">‚≠ê</span>
                    <span style="font-size: 24px; cursor: pointer;">‚≠ê</span>
                </div>
            </div>
            <div class="form-group">
                <label for="rateComment">Comentario (opcional)</label>
                <textarea id="rateComment" placeholder="Comparte tu experiencia..." rows="4"></textarea>
            </div>
            <button class="btn-primary" id="sendRateBtn">Enviar Calificaci√≥n</button>
            <button class="btn-secondary" onclick="closeModal('rateModal')">Cancelar</button>
        </div>
    </div>

    <script>
        // Simulaci√≥n de la clase ChatClient para testing
        class TestChatClient {
            constructor() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                console.log('üîç [DEBUG] Setting up event listeners...');
                
                // Botones de acci√≥n r√°pida
                const quickActions = document.querySelectorAll('.quick-action-btn');
                console.log('üîç [DEBUG] Found quick action buttons:', quickActions.length);
                quickActions.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const action = e.currentTarget.dataset.action;
                        console.log('üîç [DEBUG] Quick action button clicked:', action);
                        this.handleQuickAction(action);
                    });
                });

                // Modal listeners
                const sendTipBtn = document.getElementById('sendTipBtn');
                if (sendTipBtn) {
                    sendTipBtn.addEventListener('click', () => this.sendTip());
                }

                const sendRequestServiceBtn = document.getElementById('sendRequestServiceBtn');
                if (sendRequestServiceBtn) {
                    sendRequestServiceBtn.addEventListener('click', () => this.sendRequestService());
                }

                const sendReportBtn = document.getElementById('sendReportBtn');
                if (sendReportBtn) {
                    sendReportBtn.addEventListener('click', () => this.sendReport());
                }

                const sendRateBtn = document.getElementById('sendRateBtn');
                if (sendRateBtn) {
                    sendRateBtn.addEventListener('click', () => this.sendRating());
                }
            }

            handleQuickAction(action) {
                console.log('üîç [DEBUG] handleQuickAction called with action:', action);
                switch (action) {
                    case 'tip':
                        console.log('üîç [DEBUG] Opening tip modal');
                        this.openModal('tipModal');
                        break;
                    case 'request':
                        console.log('üîç [DEBUG] Opening request service modal');
                        this.openModal('requestServiceModal');
                        break;
                    case 'favorite':
                        console.log('üîç [DEBUG] Adding to favorites');
                        this.toggleFavorite(true);
                        break;
                    case 'report':
                        console.log('üîç [DEBUG] Opening report modal');
                        this.openModal('reportModal');
                        break;
                    case 'urgent':
                        console.log('üîç [DEBUG] Sending urgent message');
                        this.sendUrgentMessage();
                        break;
                    case 'rate':
                        console.log('üîç [DEBUG] Opening rate modal');
                        this.openModal('rateModal');
                        break;
                    default:
                        console.log('üîç [DEBUG] Unknown action:', action);
                        break;
                }
            }

            openModal(id) {
                console.log('üîç [DEBUG] openModal called with id:', id);
                const el = document.getElementById(id);
                console.log('üîç [DEBUG] Modal element found:', el);
                if (el) {
                    el.style.display = 'block';
                    console.log('üîç [DEBUG] Modal displayed');
                } else {
                    console.error('‚ùå Modal not found:', id);
                }
            }

            closeModal(id) {
                const el = document.getElementById(id);
                if (el) el.style.display = 'none';
            }

            showNotification(message, type = 'info') {
                console.log(`üîî [${type.toUpperCase()}] ${message}`);
                alert(`${type.toUpperCase()}: ${message}`);
            }

            showError(message) {
                this.showNotification(message, 'error');
            }

            async sendTip() {
                const amount = parseInt(document.getElementById('tipAmount').value || '0', 10);
                const note = document.getElementById('tipNote').value || '';
                
                if (amount <= 0) {
                    this.showError('Por favor ingresa un monto v√°lido');
                    return;
                }
                
                this.showNotification(`Propina de $${amount} enviada`, 'success');
                this.closeModal('tipModal');
            }

            async sendRequestService() {
                const title = document.getElementById('reqTitle').value || '';
                const description = document.getElementById('reqDescription').value || '';
                
                if (!title.trim() || !description.trim()) {
                    this.showError('Por favor completa t√≠tulo y descripci√≥n');
                    return;
                }
                
                this.showNotification('Solicitud de servicio enviada', 'success');
                this.closeModal('requestServiceModal');
            }

            async sendReport() {
                const reason = document.getElementById('reportReason').value || '';
                const details = document.getElementById('reportDetails').value || '';
                
                if (!reason || !details.trim()) {
                    this.showError('Por favor completa todos los campos obligatorios');
                    return;
                }
                
                this.showNotification('Reporte enviado correctamente', 'success');
                this.closeModal('reportModal');
            }

            async sendUrgentMessage() {
                this.showNotification('Mensaje urgente enviado', 'success');
            }

            async sendRating() {
                this.showNotification('Calificaci√≥n enviada', 'success');
                this.closeModal('rateModal');
            }

            toggleFavorite(state) {
                this.showNotification(state ? 'A√±adido a favoritos' : 'Eliminado de favoritos', 'success');
            }
        }

        // Funciones globales
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // Inicializar cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üîç [DEBUG] DOM loaded, initializing test...');
            window.testChatClient = new TestChatClient();
        });
    </script>
</body>
</html>